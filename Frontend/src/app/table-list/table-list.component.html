<div class="main-content">
  <div class="container-fluid">
      <div class="row">
          <div class="col-md-12">
              <div class="card">
                  <div class="card-header card-header-danger" style="display: flex;justify-content: space-between;align-items: center;">
                    <div>
                        <h4 class="card-title ">Product </h4>
                      
                    </div>
                      <div>
                        <button class="btn btn-info" data-bs-toggle="modal" data-bs-target="#addProductModal" (click)="openModal()" style="border-radius: 10px;height: 50px;">
  Add Product
</button>
                      </div>
                      
                  </div>
                  <div class="card-body">
                      <div class="table-responsive" style="overflow-x: auto; white-space: nowrap;">
                          <table class="table  table-hover">
  <thead class="text-primary">
    <tr>
      
      <th>Name</th>
      <th style="width: 12%;">Description</th>
      <th>Price</th>
      <th style="width: 9%;">Discount %</th>
      <th style="width: 9%;">Discount Price</th>
      <th style="width: 9%;">Brand</th>
      <th>Stock</th>
      <th style="width: 10%;">Image Name</th>
      <th>Image</th>
      <th>Category</th>
      <th>Active</th>
      <th style="width: 9%;">Created</th>
      <th style="width: 9%;">Updated</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let product of productResposne">
      
      <td>{{ product.name }}</td>
      <td style="width: 12%;">{{ product.description }}</td>
      <td>{{ product.price | currency }}</td>
      <td style="width: 9%;">{{ product.discountPercent || '-' }}</td>
      <td style="width: 9%;">{{ product.discountPrice || '-' }}</td>
      <td style="width: 9%;">{{ product.brand }}</td>
      <td>{{ product.stockQuantity }}</td>
      <td style="width: 10%;">{{ product.imageName }}</td>

      <!-- Render image if available -->
      <td>
        <img *ngIf="product.image" 
             [src]="'data:image/jpeg;base64,' + product.image"
             alt="Product Image"
             width="90" height="70" 
             style="object-fit: cover; border-radius: 9px;" />
      </td>

      <td>{{ categoryMap[product.categoryId] || 'Loading...' }}</td>
      <td>{{ product.isActive ? 'Yes' : 'No' }}</td>
      <td style="width: 9%;">{{ product.createdDate | date:'medium' }}</td>
      <td style="width: 9%;">{{ product.updatedDate | date:'medium' }}</td>

      <!-- Actions -->
      <td style="display: flex; gap:10px;width: 9%;">
        <button class="btn btn-sm btn-warning me-1" title="Edit"  (click)="editProduct(product)" style="border-radius: 13px;"><i class="fas fa-edit" ></i></button>
        <button class="btn btn-sm btn-danger" (click)="deleteProduct(product.id)" style="border-radius: 13px;"> <i class="fas fa-trash-alt"></i></button>
      </td>
    </tr>
  </tbody>
</table>
                      </div>
                  </div>
              </div>
          </div>
  
</div>
<div class="modal fade shadow-lg " id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg animate__animated animate__fadeInDown">
    <div class="modal-content border-0 shadow-lg">

      <form [formGroup]="productForm" (ngSubmit)="onSubmit()" enctype="multipart/form-data">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
        </div>

        <div class="modal-body">
          <div class="mb-3">
            <label>Name</label>
            <input formControlName="name" type="text" class="form-control" [ngClass]="{'is-invalid': isInvalid('name')}" required style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('name')" class="text-danger small">Name is required</div>
        </div>
          <div class="mb-3">
            <label>Description</label>
            <textarea formControlName="description" class="form-control" [ngClass]="{'is-invalid': isInvalid('description')}" style="width: 100%; height: 75px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;"></textarea>
             <div *ngIf="isInvalid('description')" class="text-danger small">Description is required</div>
        </div>
        <div style="display: flex;justify-content: space-between;">
            <div class="mb-3 " style="width: 49%;">
            <label>Price</label>
            <input formControlName="price" type="number" class="form-control" required [ngClass]="{'is-invalid': isInvalid('price')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('price')" class="text-danger small">price is required</div>
        </div>
          <div class="mb-3 " style="width: 49%;">
            <label>Discount %</label>
            <input formControlName="discountPercent" type="number" class="form-control" required [ngClass]="{'is-invalid': isInvalid('discountPercent')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('discountPercent')" class="text-danger small">Discount is required</div>
        </div>
        </div>
        <div style="display: flex;justify-content: space-between;">
              <div class="mb-3 " style="width: 49%;">
            <label>Brand</label>
            <input formControlName="brand" type="text" class="form-control"  [ngClass]="{'is-invalid': isInvalid('brand')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
            <div *ngIf="isInvalid('brand')" class="text-danger small">Brand is required</div>
        </div>
          <div class="mb-3" style="width: 49%;">
            <label>Stock Quantity</label>
            <input formControlName="stockQuantity" type="number" class="form-control" [ngClass]="{'is-invalid': isInvalid('stockQuantity')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('stockQuantity')" class="text-danger small">Stock quantity is required</div>
        </div>
        </div>
          
        
          <div class="mb-3">
            <label>Category</label>
            <select formControlName="categoryname" class="form-select custom-select w-100"   [ngClass]="{'is-invalid': isInvalid('categoryname')}" required style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); background-color: white;">
              <option *ngFor="let cat of categories" [value]="cat.name" style="padding: 10px;font-size: 20px;">{{ cat.name }}</option>
            </select>
            <div *ngIf="isInvalid('categoryname')" class="text-danger small">Category is required</div>

          </div>
          <div class="mb-3">
            <label>Image</label>
            <input type="file" class="form-control" (change)="onFileSelected($event)" required   [ngClass]="{'is-invalid': isInvalid('image')}" #fileInput style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
            <div *ngIf="isInvalid('image')" class="text-danger small">Image is required</div>

        </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success" style="width: 120px;height: 50px;border-radius: 10px;">Save</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" style="width: 120px;height: 50px;border-radius: 10px;" (click)="closeModal()" >Cancel</button>
        </div>
      </form>

    </div>
  </div>
</div>
<div class="modal fade shadow-lg " id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg animate__animated animate__fadeInDown">
    <div class="modal-content border-0 shadow-lg">

      <form [formGroup]="productForm" (ngSubmit)="onEditSubmit()" enctype="multipart/form-data">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
        </div>

        <div class="modal-body">
          <div class="mb-3">
            <label>Name</label>
            <input formControlName="name" type="text" class="form-control" [ngClass]="{'is-invalid': isInvalid('name')}" required style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('name')" class="text-danger small">Name is required</div>
        </div>
          <div class="mb-3">
            <label>Description</label>
            <textarea formControlName="description" class="form-control" [ngClass]="{'is-invalid': isInvalid('description')}" style="width: 100%; height: 75px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;"></textarea>
             <div *ngIf="isInvalid('description')" class="text-danger small">Description is required</div>
        </div>
        <div style="display: flex;justify-content: space-between;">
            <div class="mb-3 " style="width: 49%;">
            <label>Price</label>
            <input formControlName="price" type="number" class="form-control" required [ngClass]="{'is-invalid': isInvalid('price')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('price')" class="text-danger small">price is required</div>
        </div>
          <div class="mb-3 " style="width: 49%;">
            <label>Discount %</label>
            <input formControlName="discountPercent" type="number" class="form-control" required [ngClass]="{'is-invalid': isInvalid('discountPercent')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('discountPercent')" class="text-danger small">Discount is required</div>
        </div>
        </div>
        <div style="display: flex;justify-content: space-between;">
              <div class="mb-3 " style="width: 49%;">
            <label>Brand</label>
            <input formControlName="brand" type="text" class="form-control"  [ngClass]="{'is-invalid': isInvalid('brand')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
            <div *ngIf="isInvalid('brand')" class="text-danger small">Brand is required</div>
        </div>
          <div class="mb-3" style="width: 49%;">
            <label>Stock Quantity</label>
            <input formControlName="stockQuantity" type="number" class="form-control" [ngClass]="{'is-invalid': isInvalid('stockQuantity')}" style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
             <div *ngIf="isInvalid('stockQuantity')" class="text-danger small">Stock quantity is required</div>
        </div>
        </div>
          
        
          <div class="mb-3">
            <label>Category</label>
            <select formControlName="categoryname" class="form-select custom-select w-100"   [ngClass]="{'is-invalid': isInvalid('categoryname')}" required style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); background-color: white;">
              <option *ngFor="let cat of categories" [value]="cat.name" style="padding: 10px;font-size: 20px;">{{ cat.name }}</option>
            </select>
            <div *ngIf="isInvalid('categoryname')" class="text-danger small">Category is required</div>

          </div>
          <div class="mb-3" style="display: flex;justify-content: space-between;align-items: center;">
            <div style="display: flex;flex-direction: column;width: 80%;">
                <label>Image</label>
            <input type="file" class="form-control" (change)="onEditFileSelected($event)" required   [ngClass]="{'is-invalid': isInvalid('image')}" #fileInput style="width: 100%; height: 45px; border: 2px solid rgb(115, 113, 113); border-radius: 8px;">
            <div *ngIf="isInvalid('image')" class="text-danger small">Image is required</div>
            </div>
            <!-- <div >
                <img *ngIf="{productImage}" 
             [src]="'data:image/jpeg;base64,' + editProductImage"
             alt="Product Image"
             width="90" height="70" 
             style="object-fit: cover; border-radius: 9px;" />
            </div> -->
            <div>
  <img
    *ngIf="productImage && editProductImageUrl"
    [src]="editProductImageUrl"
    alt="Product Image"
    width="90"
    height="70"
    style="object-fit: cover; border-radius: 9px;"
  />
</div>
            

        </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success" style="width: 120px;height: 50px;border-radius: 10px;">Save</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" style="width: 120px;height: 50px;border-radius: 10px;" (click)="closedEditModal()" >Cancel</button>
        </div>
      </form>

    </div>
  </div>
</div>



          <!-- <div class="col-md-12">
              <div class="card card-plain">
                  <div class="card-header card-header-danger">
                      <h4 class="card-title mt-0"> Table on Plain Background</h4>
                      <p class="card-category"> Here is a subtitle for this table</p>
                  </div>
                  <div class="card-body">
                      <div class="table-responsive">
                          <table class="table table-hover">
                              <thead class="">
                                  <th>
                                      ID
                                  </th>
                                  <th>
                                      Name
                                  </th>
                                  <th>
                                      Country
                                  </th>
                                  <th>
                                      City
                                  </th>
                                  <th>
                                      Salary
                                  </th>
                              </thead>
                              <tbody>
                                  <tr>
                                      <td>
                                          1
                                      </td>
                                      <td>
                                          Dakota Rice
                                      </td>
                                      <td>
                                          Niger
                                      </td>
                                      <td>
                                          Oud-Turnhout
                                      </td>
                                      <td>
                                          $36,738
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>
                                          2
                                      </td>
                                      <td>
                                          Minerva Hooper
                                      </td>
                                      <td>
                                          Curaçao
                                      </td>
                                      <td>
                                          Sinaai-Waas
                                      </td>
                                      <td>
                                          $23,789
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>
                                          3
                                      </td>
                                      <td>
                                          Sage Rodriguez
                                      </td>
                                      <td>
                                          Netherlands
                                      </td>
                                      <td>
                                          Baileux
                                      </td>
                                      <td>
                                          $56,142
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>
                                          4
                                      </td>
                                      <td>
                                          Philip Chaney
                                      </td>
                                      <td>
                                          Korea, South
                                      </td>
                                      <td>
                                          Overland Park
                                      </td>
                                      <td>
                                          $38,735
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>
                                          5
                                      </td>
                                      <td>
                                          Doris Greene
                                      </td>
                                      <td>
                                          Malawi
                                      </td>
                                      <td>
                                          Feldkirchen in Kärnten
                                      </td>
                                      <td>
                                          $63,542
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>
                                          6
                                      </td>
                                      <td>
                                          Mason Porter
                                      </td>
                                      <td>
                                          Chile
                                      </td>
                                      <td>
                                          Gloucester
                                      </td>
                                      <td>
                                          $78,615
                                      </td>
                                  </tr>
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div> -->
